{% extends 'enterprise/layout.html' %}
{% block title %}Enterprise Profile{% endblock %}
{% block enterprise_content %}
<div class="ent-card" style="max-width: 600px; margin: 0 auto;">
    <h2 style="margin-bottom: 20px;">Organization Profile</h2>
    <p style="color: var(--text-secondary); margin-bottom: 24px;">Manage bank details and configuration for <strong>{{
            session.get('active_business') }}</strong>.</p>

    {% if bank %}
    <form method="POST" action="{{ url_for('enterprise.ent_profile') }}">
        <div class="form-group">
            <label>Business Name</label>
            <input type="text" value="{{ bank.business_name }}" disabled
                style="background-color: var(--bg-secondary); cursor: not-allowed; opacity: 0.8;"
                title="Business Name cannot be changed here.">
        </div>

        <div class="form-group">
            <label>Account Type</label>
            <select name="account_type" required>
                <option value="Current" {{ 'selected' if bank.account_type=='Current' else '' }}>Current Account
                    (Liquid)</option>
                <option value="CC/OD" {{ 'selected' if bank.account_type=='CC/OD' else '' }}>CC/OD Account
                    (Credit/Overdraft)</option>
            </select>
        </div>

        <div class="form-group">
            <label>Bank Name</label>
            <input type="text" name="bank_name" value="{{ bank.bank_name }}" required>
        </div>

        <div class="form-group">
            <label>Account Number</label>
            <input type="text" name="account_number" value="{{ bank.account_number }}" required>
        </div>

        <div class="form-group">
            <label>IFSC Code</label>
            <input type="text" name="ifsc_code" value="{{ bank.ifsc_code }}" required>
        </div>

        <div class="form-group">
            <label>Opening Balance</label>
            <input type="number" step="0.01" value="{{ bank.opening_balance or 0 }}" disabled
                style="background-color: var(--bg-secondary); cursor: not-allowed; opacity: 0.8;"
                title="Opening Balance cannot be changed here.">
        </div>

        <div style="margin-top: 32px;">
            <button type="submit" class="btn-primary" style="width: 100%;">Save Changes</button>
        </div>
    </form>
    {% else %}
    <div
        style="text-align: center; padding: 40px; background: rgba(0,0,0,0.02); border: 1px dashed rgba(0,0,0,0.1); border-radius: 12px;">
        <p>No primary bank account found for this organization.</p>
        <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 10px;">Please configure it from the main
            Banks page.</p>
    </div>
    {% endif %}
</div>

<div class="ent-card" style="max-width: 600px; margin: 32px auto 0;">
    <h2 style="margin-bottom: 20px;">Change Security PIN</h2>
    <p style="color: var(--text-secondary); margin-bottom: 24px;">Update the 4-digit security PIN used to access this
        business account.</p>

    <form method="POST" action="{{ url_for('enterprise.ent_update_pin') }}">
        <div class="form-group">
            <label>New Security PIN</label>
            <input type="password" name="new_pin" pattern="\d{4}" title="Please enter exactly 4 digits"
                placeholder="Enter new 4-digit PIN" required>
        </div>

        <div class="form-group">
            <label>Confirm Security PIN</label>
            <input type="password" name="confirm_pin" pattern="\d{4}" title="Please enter exactly 4 digits"
                placeholder="Confirm new 4-digit PIN" required>
        </div>

        <div style="margin-top: 32px;">
            <button type="submit" class="btn-primary" style="width: 100%;">Save PIN</button>
        </div>
    </form>
</div>
{% endblock %}