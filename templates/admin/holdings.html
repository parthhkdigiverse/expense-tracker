{% extends "admin/layout.html" %}

{% block content %}
<div class="dashboard-header" style="margin-bottom: 20px;">
    <div class="header-content">
        <h1>Global Holdings Oversight</h1>
        <p style="color: var(--text-secondary); margin-top: 5px;">Platform-wide view of all pending enterprise debts and
            payments.</p>
    </div>
</div>

<div class="admin-table-container">
    <table class="admin-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Business Name</th>
                <th>Creator User</th>
                <th>Holding Name</th>
                <th>Type</th>
                <th>Amount</th>
                <th>Paid Amount</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for holding in holdings %}
            <tr>
                <td>{{ holding.created_at[:10] }}</td>
                <td style="font-weight: 500;">{{ holding.business_name }}</td>
                <td>
                    <div style="line-height: 1.2;">
                        <span style="display: block;">{{ holding.profiles.full_name or "Unknown User" }}</span>
                        <span style="font-size: 0.8em; color: var(--text-secondary);">{{ holding.profiles.email or "No
                            Email" }}</span>
                    </div>
                </td>
                <td style="font-weight: 500;">{{ holding.name }}</td>
                <td>
                    {% if holding.type == 'receivable' %}
                    <span
                        style="color: #10b981; font-weight: bold; background: rgba(16, 185, 129, 0.1); padding: 2px 8px; border-radius: 12px; font-size: 0.8em; text-transform: uppercase;">Receivable</span>
                    {% else %}
                    <span
                        style="color: #ef4444; font-weight: bold; background: rgba(239, 68, 68, 0.1); padding: 2px 8px; border-radius: 12px; font-size: 0.8em; text-transform: uppercase;">Payable</span>
                    {% endif %}
                </td>
                <td style="font-weight: 600;">{{ '₹{:,.2f}'.format(holding.amount|float) }}</td>
                <td style="color: var(--text-secondary);">{{ '₹{:,.2f}'.format(holding.paid_amount|float) }}</td>
                <td>
                    {% if holding.status == 'settled' %}
                    <span style="color: #10b981;">Settled</span>
                    {% elif holding.status == 'partial' %}
                    <span style="color: #f59e0b;">Partial</span>
                    {% else %}
                    <span style="color: #ef4444;">Pending</span>
                    {% endif %}
                </td>
                <td style="display: flex; gap: 8px;">
                    <form method="POST" action="{{ url_for('admin.delete_holding', holding_id=holding.id) }}"
                        style="display:inline;">
                        <button type="submit" class="btn-danger"
                            style="padding: 4px 10px; border-radius: 4px; font-size: 0.85em;"
                            onclick="return confirm('WARNING: Are you sure you want to permanently delete this holding payment from the enterprise database? This action is irreversible.');">Delete</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="9" style="text-align: center; padding: 40px; color: var(--text-secondary);">No active
                    holdings recorded.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}